<!-- TODO Refactor question_detail.html and children templates.
BODY templates/questions/question_detail.html
BODY Their structure is convoluted and confusing.
 -->
{% extends "base_study.html" %}
{% load render_bundle from webpack_loader %}

{% block styles %}
    <!-- Webpack bundle: "topics" CSS -->
    {% render_bundle 'questions' 'css' %}
    {% render_bundle 'question_comparison' 'css' %}
{% endblock styles %}

{% block scripts %}
{% endblock %}
{% block title %}
    {{ question.instrument.title }}/{{ question.name }}
{% endblock %}
{% block content %}
    <div id="question-id" class="hidden">{{ question.id }}</div>
    {{ question_items|json_script:"question-meta" }}
    <div class="row">
        <div class="col-xl-9">
            <div class="card">
                <div class="card-header question-navigation-header">

    
                    {% if question.previous_question %}
                        <a href="{{ question.previous_question }}"
                           class="question-navigation">
                            <i class="fa fa-arrow-circle-left" title="Previous question">
                            </i>
                        </a>
                    {% endif %}
                    <h2 class="text-center">
                    {{ question.name }}
                    </h2>
                    {% if question.next_question %}
                        <a href="{{ question.next_question }}"
                           class="question-navigation">
                            <i class="fas fa-arrow-circle-right" title="Next question">
                            </i>
                        </a>
                    {% endif %}


                </div>
                <div class="card-body" id="question-items">
                </div>
            </div>
            <div class="card">
                <div class="card-header">
                    <h2 class="text-center">DE</h2>
                </div>
                <div class="card-body" id="question-items-de">
                </div>
            </div>
            {% include "questions/related_questions.html" with question_list=related_questions table_name="Related questions" %}
        </div>
        <div class="col-xl-3">
            {% include "questions/question_info.html" with question_list=related_questions %}
            <div class="card">
                <div class="card-header"><b>Variables</b>
                </div>
                {% if variables %}
                    <div class="list-group">
                        {% for variable in variables %}
                        <div class="list-group-item">
                            <div>
                                <i class="fa fa-table"></i>
                                <a href="{{ variable.dataset.get_direct_url }}">
                                    {{ variable.dataset.name }} &#x2013;
                                    <small>{{ variable.dataset.label }}</small>
                                </a>
                            </div>
                            <div>
                                <i class="fa fa-chart-bar"></i> 
                                <a href="{{ variable.get_direct_url }}">
                                    {{ variable.name }} &#x2013;
                                    <small>{{ variable.label }}</small>
                                </a>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                {% else %}
                    <div class="card-body">
                        <p>no related variables found</p>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
    <div id="question-diff">
    </div>
{% render_bundle 'questions' 'js' %}
{% render_bundle 'question_comparison' 'js' %}
{% render_bundle 'description_modal' 'js' %}
{% endblock content %}
