language: python
python: "3.6"
cache:
  - pip
  - npm
node_js: 10
addons:
  firefox: latest
before_install:
  - npm i -g npm@6.4.1
  - wget https://github.com/mozilla/geckodriver/releases/download/v0.23.0/geckodriver-v0.23.0-linux64.tar.gz
  - tar -xzf geckodriver-v0.23.0-linux64.tar.gz
  - mv geckodriver tests/geckodriver
install:
  - pip install pipenv
  - pipenv install --dev
  - pipenv run paver copy_secrets_file
  - pipenv run paver install_elastic
  - db/elasticsearch/bin/elasticsearch -d
  - pipenv run paver setup_frontend
before_script:
  - sleep 10
script:
#  - pytest
#  - pytest -m "functional" tests/functional/test_system_import.py --cov-append
#  - pytest -m "functional" tests/functional/test_study_import.py::TestStudyImport --cov-append
  - pytest -m "functional" tests/functional/test_browser.py::TestNavigation --driver Firefox --driver-path tests/geckodriver --cov-append
after_success:
  - codecov
